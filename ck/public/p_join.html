<!doctype html>
<html>
    <head>
        <link rel="stylesheet" href="./css/bono.css" />
        <link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>
        <script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
        <script src="http://code.jquery.com/jquery-1.11.1.js"></script>
        <script>
            var user_name = 'chgyubono'; // 세션에서 얻어야 함
            var project_name;

            var main = function() {
                var pjoin = io.connect('http://127.0.0.1:3000/p_join');

                // 아이디 전송
                pjoin.on('connect', function(){
                    console.log('connected');
                });

                // 프로젝트 정보 받아서 화면 갱신
                pjoin.on('p_join_response', function(msg){

                    if (msg == 'failure')
                    {
                        console.log('failed to join project.');
                    }
                    else if (msg == 'success')
                    {
                        parent.location = "p_view.html"
                    }
                });

                $('#btn-join').click(function(){

                    project_name = $('#project_name').val();

                    if (project_name.trim() === "")
                    {
                        console.log("enter project name.")
                    }
                    else
                    {
                        var json = JSON.stringify({ user_name: user_name, project_name: project_name });
                        console.log(json);
                        pjoin.emit('p_join_request', json);
                    }
                });
            };

            $(document).ready(main);
        </script>
    </head>
    <body>
        <div id="join">
            <div class="container">
                <p>project name</p>
                <input type="text" id="project_name"/>
                <button id="btn-join">join</button>
                </div>
            </div>
        </div>
    </body>
</html>
