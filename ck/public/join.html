<!doctype html>
<html>
    <head>
    <link rel="stylesheet" href="./css/bono.css" />
        <link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>
        <script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
        <script src="http://code.jquery.com/jquery-1.11.1.js"></script>
        <script>
            var user_name, password, password_verification, email;

            var main = function() {
                var join = io.connect('http://127.0.0.1:3000/join');

                // 아이디 전송
                join.on('connect', function(){
                    console.log('connected');
                });

                join.on('join_response', function(msg){
                    
                    if (msg == 'failure')
                    {
                        console.log('회원가입할 수 없습니다.');
                    }
                    else if (msg == 'success')
                    {
                        parent.location = 'login.html';
                    }
                });

                $('#join').click(function(){
                    
                    user_name = $('#name').val();
                    password = $('#pw1').val();
                    password_verification = $('#pw2').val();
                    email = $('#email').val();
                    
                    if (user_name.trim() === "")
                    {
                        console.log("enter id");
                    }
                    else if (password.trim() === "")
                    {
                        console.log("enter password");
                    }
                    else if (password !== password_verification)
                    {
                        console.log("password not correct");
                        // 애니메이션 추가
                        
                    }
                    else if (email.trim() === "")
                    {
                        console.log("enter email");
                    }
                    else
                    {
                        // finallY!
                        var json = JSON.stringify({
                            user: user_name,
                            password: password,
                            email: email
                        });
                        console.log(json);
                        join.emit('join_request', json);
                    }
                });
            }

            $(document).ready(main);
        </script>
    </head>
    <body>
        <div id="login">
            <div class="container">
                <ul>
                    <li><p>username</p>
                        <input id="name" type="text" /></li>
                    <li><p>password</p>
                        <input id="pw1" type="password" /></li>
                    <li><p>password verification</p>
                        <input id="pw2" type="password" /></li>
                    <li><p>email</p>
                    <input id="email" type="text" /></li>
                    <li><button id="join">join now</button></li>
                    <li><button id="cancel" onclick="parent.location='login.html'">cancel</button></li>
                </ul>
            </div>
        </div>
    </body>
</html>